import{D as r,o as n,b as u,B as f}from"./entry.b9153a06.js";import"./entry.7291cd7f.js";var o={name:"InputMask",emits:["update:modelValue","focus","blur","keydown","complete","keypress","paste"],props:{modelValue:null,slotChar:{type:String,default:"_"},mask:{type:String,default:null},autoClear:{type:Boolean,default:!0},unmask:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1}},watch:{mask(e,t){t!==e&&this.initMask()}},mounted(){this.initMask()},updated(){this.isValueUpdated()&&this.updateValue()},methods:{onInput(e){this.androidChrome?this.handleAndroidInput(e):this.handleInputChange(e),this.$emit("update:modelValue",e.target.value)},onFocus(e){if(this.readonly)return;this.focus=!0,clearTimeout(this.caretTimeoutId);let t;this.focusText=this.$el.value,t=this.checkVal(),this.caretTimeoutId=setTimeout(()=>{this.$el===document.activeElement&&(this.writeBuffer(),t===this.mask.replace("?","").length?this.caret(0,t):this.caret(t))},10),this.$emit("focus",e)},onBlur(e){if(this.focus=!1,this.checkVal(),this.updateModel(e),this.$el.value!==this.focusText){let t=document.createEvent("HTMLEvents");t.initEvent("change",!0,!1),this.$el.dispatchEvent(t)}this.$emit("blur",e)},onKeyDown(e){if(this.readonly)return;let t=e.which||e.keyCode,s,i,l,h=/iphone/i.test(r.getUserAgent());this.oldVal=this.$el.value,t===8||t===46||h&&t===127?(s=this.caret(),i=s.begin,l=s.end,l-i===0&&(i=t!==46?this.seekPrev(i):l=this.seekNext(i-1),l=t===46?this.seekNext(l):l),this.clearBuffer(i,l),this.shiftL(i,l-1),this.updateModel(e),e.preventDefault()):t===13?(this.$el.blur(),this.updateModel(e)):t===27&&(this.$el.value=this.focusText,this.caret(0,this.checkVal()),this.updateModel(e),e.preventDefault()),this.$emit("keydown",e)},onKeyPress(e){if(!this.readonly){var t=e.which||e.keyCode,s=this.caret(),i,l,h,a;e.ctrlKey||e.altKey||e.metaKey||t<32||(t&&t!==13&&(s.end-s.begin!==0&&(this.clearBuffer(s.begin,s.end),this.shiftL(s.begin,s.end-1)),i=this.seekNext(s.begin-1),i<this.len&&(l=String.fromCharCode(t),this.tests[i].test(l)&&(this.shiftR(i),this.buffer[i]=l,this.writeBuffer(),h=this.seekNext(i),/android/i.test(r.getUserAgent())?setTimeout(()=>{this.caret(h)},0):this.caret(h),s.begin<=this.lastRequiredNonMaskPos&&(a=this.isCompleted()))),e.preventDefault()),this.updateModel(e),a&&this.$emit("complete",e),this.$emit("keypress",e))}},onPaste(e){this.handleInputChange(e),this.$emit("paste",e)},caret(e,t){let s,i,l;if(!(!this.$el.offsetParent||this.$el!==document.activeElement))if(typeof e=="number")i=e,l=typeof t=="number"?t:i,this.$el.setSelectionRange?this.$el.setSelectionRange(i,l):this.$el.createTextRange&&(s=this.$el.createTextRange(),s.collapse(!0),s.moveEnd("character",l),s.moveStart("character",i),s.select());else return this.$el.setSelectionRange?(i=this.$el.selectionStart,l=this.$el.selectionEnd):document.selection&&document.selection.createRange&&(s=document.selection.createRange(),i=0-s.duplicate().moveStart("character",-1e5),l=i+s.text.length),{begin:i,end:l}},isCompleted(){for(let e=this.firstNonMaskPos;e<=this.lastRequiredNonMaskPos;e++)if(this.tests[e]&&this.buffer[e]===this.getPlaceholder(e))return!1;return!0},getPlaceholder(e){return e<this.slotChar.length?this.slotChar.charAt(e):this.slotChar.charAt(0)},seekNext(e){for(;++e<this.len&&!this.tests[e];);return e},seekPrev(e){for(;--e>=0&&!this.tests[e];);return e},shiftL(e,t){let s,i;if(!(e<0)){for(s=e,i=this.seekNext(t);s<this.len;s++)if(this.tests[s]){if(i<this.len&&this.tests[s].test(this.buffer[i]))this.buffer[s]=this.buffer[i],this.buffer[i]=this.getPlaceholder(i);else break;i=this.seekNext(i)}this.writeBuffer(),this.caret(Math.max(this.firstNonMaskPos,e))}},shiftR(e){let t,s,i,l;for(t=e,s=this.getPlaceholder(e);t<this.len;t++)if(this.tests[t])if(i=this.seekNext(t),l=this.buffer[t],this.buffer[t]=s,i<this.len&&this.tests[i].test(l))s=l;else break},handleAndroidInput(e){var t=this.$el.value,s=this.caret();if(this.oldVal&&this.oldVal.length&&this.oldVal.length>t.length){for(this.checkVal(!0);s.begin>0&&!this.tests[s.begin-1];)s.begin--;if(s.begin===0)for(;s.begin<this.firstNonMaskPos&&!this.tests[s.begin];)s.begin++;this.caret(s.begin,s.begin)}else{for(this.checkVal(!0);s.begin<this.len&&!this.tests[s.begin];)s.begin++;this.caret(s.begin,s.begin)}this.isCompleted()&&this.$emit("complete",e)},clearBuffer(e,t){let s;for(s=e;s<t&&s<this.len;s++)this.tests[s]&&(this.buffer[s]=this.getPlaceholder(s))},writeBuffer(){this.$el.value=this.buffer.join("")},checkVal(e){this.isValueChecked=!0;let t=this.$el.value,s=-1,i,l,h;for(i=0,h=0;i<this.len;i++)if(this.tests[i]){for(this.buffer[i]=this.getPlaceholder(i);h++<t.length;)if(l=t.charAt(h-1),this.tests[i].test(l)){this.buffer[i]=l,s=i;break}if(h>t.length){this.clearBuffer(i+1,this.len);break}}else this.buffer[i]===t.charAt(h)&&h++,i<this.partialPosition&&(s=i);return e?this.writeBuffer():s+1<this.partialPosition?this.autoClear||this.buffer.join("")===this.defaultBuffer?(this.$el.value&&(this.$el.value=""),this.clearBuffer(0,this.len)):this.writeBuffer():(this.writeBuffer(),this.$el.value=this.$el.value.substring(0,s+1)),this.partialPosition?i:this.firstNonMaskPos},handleInputChange(e){if(!this.readonly){var t=this.checkVal(!0);this.caret(t),this.updateModel(e),this.isCompleted()&&this.$emit("complete",e)}},getUnmaskedValue(){let e=[];for(let t=0;t<this.buffer.length;t++){let s=this.buffer[t];this.tests[t]&&s!==this.getPlaceholder(t)&&e.push(s)}return e.join("")},updateModel(e){let t=this.unmask?this.getUnmaskedValue():e.target.value;this.$emit("update:modelValue",this.defaultBuffer!==t?t:"")},updateValue(e=!0){this.$el&&(this.modelValue==null?(this.$el.value="",e&&this.$emit("update:modelValue","")):(this.$el.value=this.modelValue,this.checkVal(),setTimeout(()=>{if(this.$el&&(this.writeBuffer(),this.checkVal(),e)){let t=this.unmask?this.getUnmaskedValue():this.$el.value;this.$emit("update:modelValue",this.defaultBuffer!==t?t:"")}},10)),this.focusText=this.$el.value)},initMask(){this.tests=[],this.partialPosition=this.mask.length,this.len=this.mask.length,this.firstNonMaskPos=null,this.defs={9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"};let e=r.getUserAgent();this.androidChrome=/chrome/i.test(e)&&/android/i.test(e);let t=this.mask.split("");for(let s=0;s<t.length;s++){let i=t[s];i==="?"?(this.len--,this.partialPosition=s):this.defs[i]?(this.tests.push(new RegExp(this.defs[i])),this.firstNonMaskPos===null&&(this.firstNonMaskPos=this.tests.length-1),s<this.partialPosition&&(this.lastRequiredNonMaskPos=this.tests.length-1)):this.tests.push(null)}this.buffer=[];for(let s=0;s<t.length;s++){let i=t[s];i!=="?"&&(this.defs[i]?this.buffer.push(this.getPlaceholder(s)):this.buffer.push(i))}this.defaultBuffer=this.buffer.join(""),this.updateValue(!1)},isValueUpdated(){return this.unmask?this.modelValue!=this.getUnmaskedValue():this.defaultBuffer!==this.$el.value&&this.$el.value!==this.modelValue}},computed:{filled(){return this.modelValue!=null&&this.modelValue.toString().length>0},inputClass(){return["p-inputmask p-inputtext p-component",{"p-filled":this.filled}]}}};const d=["readonly"];function c(e,t,s,i,l,h){return n(),u("input",{class:f(h.inputClass),readonly:s.readonly,onInput:t[0]||(t[0]=(...a)=>h.onInput&&h.onInput(...a)),onFocus:t[1]||(t[1]=(...a)=>h.onFocus&&h.onFocus(...a)),onBlur:t[2]||(t[2]=(...a)=>h.onBlur&&h.onBlur(...a)),onKeydown:t[3]||(t[3]=(...a)=>h.onKeyDown&&h.onKeyDown(...a)),onKeypress:t[4]||(t[4]=(...a)=>h.onKeyPress&&h.onKeyPress(...a)),onPaste:t[5]||(t[5]=(...a)=>h.onPaste&&h.onPaste(...a))},null,42,d)}o.render=c;export{o as default};
